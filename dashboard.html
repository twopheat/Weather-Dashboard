<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="assets/css/style.css">
    <title>Brad|J - Weather Dashboard</title>
  </head>
  <body>
   <header class="navhead">
      <div id="logo">
          <img id="logopic" src="assets/images/logo.png" alt="Logo">
      </div>
      <nav class="navbar navbar-expand-lg navbar-light bg-white">
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
          <a class="navbar-brand" href="#"></a>
      
          <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
            <div class="navbar-nav float-right text-right pr-3">

              <a class="nav-item nav-link" href="contact.html">Contact</a><a class="bar">|</a>
              <a class="nav-item nav-link" href="dashboard.html">Dashboard</a><a class="bar">|</a>
              <a class="nav-item nav-link" href="portfolio.html">Portfolio</a><a class="bar">|</a>
              <a class="nav-item nav-link active" href="index.html">About <span class="sr-only">(current)</span></a>
              
            </div>
          </div>
        </nav>

      
   </header>
  
   
    <div class="container mt-5">
      
      <h1 class="text-white bg-secondary ptitle">Weather Dashboard</h1>
     
     <div class="card">
          
        <form id="form" class="card-body">
           <div class="row">
            <div class="col-sm-4 pt-4 bg-light">

              <!-- form for handling input + create text box for city search-->
              <div class="form-group">
                <input type="text" placeholder="Pick a City..." class="form-input form-control" id="city-field">
                <button type="submit" class="city-search btn btn-default" id="city-search">
                    <i class="fa fa-search"></i> Search</button>
                <button class="btn btn-default" id="clear-all">
                    <i class="fa fa-trash"></i> Clear</button>
              </div>
            </form>


                <div>
                    <label class="col">Search History</label>
                    <div id="city-list" placeholder="No Query Yet" class="col p-3 bg-white rounded-top border border-bottom1"></div>
                </div>
            </div>

          <div class="col-sm-8">

                <button id="current-weather" class="col-sm-12 shadow-sm rounded-lg pt-5 pb-5 bg-white"></button>
                <button id="5day-weather" class="col-sm-12 card pt-5 pb-5 bg-white"></button>


          </div>

      </div>

     </div>

    </div>

   
    
   
  

 <footer>
    <p id="copyright">Brad|J</p>
 </footer>

 <script type="text/javascript">
    // queryURL is the API url and Set the API key
    var wAppId = '1583681dac81837eff11223ef03cd809',
        wURL = 'https://api.openweathermap.org/data/2.5/forecast';
    var cAppId = "bbea62cdba22465b7f7589c50dd2081e",
        cURL = "https://api.openweathermap.org/data/2.5/weather";


  var readyData = function(units) {

    var cityField = $('#city-field').val()

    if (cityField && cityField != ''){
      cityField = cityField.trim()
      getData1(wURL, cityField, wAppId, units)
      getData2(cURL, cityField, cAppId, units)
      $('#city-list').append('<button class="btn-lg bg-white re-list">' + cityField.toUpperCase() + '</button>'+'</br></br>')
    }
    else {
      alert('City field is empty!')
    }
    }

  /*var relistData = function(units) {

    var reList = $('.re-list').val()

    if (reList && reList != ''){
     reList = reList.trim()
     getData(wURL, reList, wAppId, units)
     }
   };*/

  
  $(document).ready(function() {
    $('.city-search').click(function() {
       event.preventDefault();
       readyData('imperial');
    });
    $('#city-field').submit(function() {
       event.preventDefault();
       readyData('imperial');
    });
    $('#clear-all').click(function() {
       event.preventDefault();
       reset();
    });
  });

  function getData1(url, cityName, appId, units) {
    var request = $.ajax({
      url:url,
      crossDomain:true,
      dataType: "jsonp",
      contentType:'text/plain',
      data: {q: cityName, appid: wAppId, units:units},
      jsonpCallback: "fetchData1",
      type:"GET"
    })
   };
   

  function fetchData1 (forecast) {
    console.log(forecast)
    var html = '',
      cityName = forecast.city.name;

      html += '<h4> 5-Day Forecast for ' + cityName + '</h4>'
    forecast.list.forEach(function(forecastEntry, index, list) {
      html += '<div class="row">' + '<div class="left col-4 pt-1 pb-1 card shadow-sm rounded-sm">' + forecastEntry.dt_txt + ': ' + forecastEntry.main.temp.toFixed(0) + '°</div>' + '</div>'
                
    })
   
    $('#5day-weather').html(html)
   };

//---------------------------fetch 2-------------------


function getData2(url, cityName, appId, units) {
    var request = $.ajax({
      url:url,
      crossDomain:true,
      dataType: "jsonp",
      contentType:'text/plain',
      data: {q: cityName, appid: cAppId, units:units},
      jsonpCallback: "fetchData2",
      type:"GET"
    })
   };
   

  function fetchData2 (weather) {
    console.log(weather)
    var html = '',
      cityName = weather.name;

      html += '<h4> Current Forecast for ' + cityName + '</h4>'
    
      html += '<div class="row">'+ '<div class="col-sm pt-4 pb-4 card shadow-sm rounded-sm">' + weather.dt + ': ' + weather.main.temp.toFixed(0) + '°</div>' + '</div>'
                
    
   
    $('#current-weather').html(html)
   };

 </script>
</body>
</html>
